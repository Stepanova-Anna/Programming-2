# Лабораторная работа 4
## Цель задания
> Разработать приложение для получения курсов валют с сайта Центробанка России, используя объектно-ориентированный подход и архитектурный паттерн MVC (Model-View-Controller).
> Требования к функционалу
> Компонент Model:

>- Представляет собой класс CurrencyRates, который отправляет запросы к сайту ЦБ РФ.

>- На вход принимает список отслеживаемых валют (строки длины три, например, ["USD", "EUR", "GBP"]).

>- Реализует паттерн "Одиночка" (Singleton), чтобы в приложении существовал только один объект данного класса.

>- Использует геттер для получения текущих курсов валют.

> -Использует сеттер для обновления списка отслеживаемых валют.

> Компонент View:

>- Использует шаблонизатор Jinja2 или какую-либо другую библиотеку (пример) для отображения данных.

>- Позволяет пользователю просматривать курсы валют в удобном формате.

> Компонент Controller:

>- Обрабатывает запросы и управляет логикой приложения.

>- Сохраняет полученные данные в базу данных SQLite3 (реализован именованный стиль для параметризации запросов в БД).

>- Передаёт данные в представление для отображения.

> Дополнительные требования
>- Данные должны загружаться с официального API или XML-файла Центробанка России.

>- Для взаимодействия с API можно использовать библиотеку requests.

>- Использование библиотек sqlite3 для работы с базой данных и jinja2 для шаблонов.

> Этапы выполнения
> -Реализовать класс CurrencyRates (паттерн "Одиночка").

> -Реализовать контроллер для обработки запросов и сохранения данных в SQLite3.

> -Разработать шаблоны на Jinja2 для отображения информации.

> -Написать код для интеграции всех компонентов в MVC-структуре.

> Протестировать приложение, проверив работу с разными валютами.

### Результат:

Структура проекта

![Лабораторная работа 4. Задание 1](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR4-4sem/2.png)

Вывод данных: 

![Лабораторная работа 4. Задание 1](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR4-4sem/1.png)

**Особенности реализации:**
- Полностью соответствует требованиям MVC

- Использует Singleton для модели CurrencyRates

- Сохраняет данные в SQLite

- Отображает курсы через Jinja2 шаблоны

- Получает актуальные курсы с сайта ЦБ РФ

[**Контроллер**](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR4-4sem/controlers/__init__.py)

**Работа с БД:**

`init_db()` - создает таблицу для хранения курсов валют (если не существует)

`save_rates()` - очищает таблицу и сохраняет новые курсы из словаря rates

**Основные методы:**

`get_rates_view()` - получает курсы из модели, сохраняет в БД и возвращает HTML-шаблон с данными

`update_currencies()` - обновляет список отслеживаемых валют и возвращает обновленное представление

[**Модель**](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR4-4sem/model.py)

**`Singleton` паттерн:**

`_instance` хранит единственный экземпляр класса

`__new__` гарантирует создание только одного объекта

**Основные методы:**

`fetch_rates():`

- Делает запрос к API ЦБ РФ (XML-формат)

- Парсит ответ и извлекает курсы для заданных валют

- Нормализует значения (учитывает номинал, например, для 1 USD вместо 100 JPY)

- Сохраняет дату обновления

**Дополнительные методы:**

`get_rates():` возвращает текущие курсы в формате словаря

`set_currencies():` обновляет список отслеживаемых валют



