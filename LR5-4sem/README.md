# Лабораторная работа 5
## Задание
**Цель задания**
Разработать веб-приложение на языке Python с использованием фреймворка Flask, реализующее архитектуру MVC (Model-View-Controller). Приложение должно получать курсы указанных валют с сайта Центробанка РФ и отображать их пользователю. В реализации необходимо использовать объектно-ориентированный подход, шаблонизатор Jinja2 и SQLite3 для хранения данных.

**Требования к функционалу**
Компонент Model:

- Принимает список кодов валют (например, ['USD', 'EUR', 'GBP']);
- Отправляет запрос к сайту Центробанка РФ и получает данные о курсах;
- Реализует геттер для получения текущих отслеживаемых валют и их курсов;
- Реализует сеттер для изменения списка отслеживаемых валют;
- Реализован по паттерну проектирования Singleton (Одиночка) — в приложении может существовать только один экземпляр CurrencyRates.
- Для работы с данными и базой данных используется ORM (например, SQLAlchemy или Django ORM).  

Компонент View:

- Использует шаблонизатор Jinja2 для отображения данных.
- Позволяет пользователю просматривать курсы валют в удобном формате.
- Компонент Controller:
- Получают список валют от пользователя;
- Обновляют список валют в модели;
- Сохраняют данные о курсах валют в базу данных SQLite3;
- Извлекают актуальные данные и передают их в шаблон для отображения.

Дополнительные требования
- Код должен быть структурирован по принципам MVC;
- Данные должны загружаться с официального API или XML-файла Центробанка России.
- Предусмотреть обработку ошибок (например, недопустимый код валюты, недоступность сайта ЦБ);
- Для взаимодействия с API можно использовать библиотеку requests.
- Использование библиотек sqlite3 для работы с базой данных и jinja2 для шаблонов.
- Приложение должно быть запущено через Flask (flask run).

**Этапы выполнения**
- Реализовать класс CurrencyRates (паттерн "Одиночка").

- Реализовать контроллер для обработки запросов и сохранения данных в SQLite3.

- Разработать шаблоны на Jinja2 для отображения информации.

- Написать код для интеграции всех компонентов в MVC-структуре.

- Протестировать приложение, проверив работу с разными валютами.

Примерная структура проекта на Flask:

currency_app/

├── app.py               # Главный файл Flask-приложения

├── model.py             # Класс CurrencyRates

├── controller.py        # Логика обработки маршрутов

├── templates/           # Шаблоны Jinja2

│   ├── index.html

│   └── update.html

├── static/              # Статические файлы (если нужно)

├── database.db          # SQLite база данных

└── requirements.txt     # Список зависимостей

---

## Результат

[**Папка с проектом**](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR5-4sem/current-app)

Архитектура MVC
Проект следует паттерну Model-View-Controller:

*Model - CurrencyRates:*

- Отвечает за работу с данными (API ЦБ + SQLite)

- Реализует паттерн Singleton через `__new__`

- Использует SQLAlchemy для ORM-маппинга

*View - Jinja2 шаблоны:*

- `index.html` - отображает текущие курсы

- `update.html` - форма для обновления списка валют

*Controller - CurrencyController:*

- Обрабатывает HTTP-запросы

- Координирует работу модели и представления

- Возвращает готовый HTML



Singleton в model.py:

```
def __new__(cls, app):
    if cls._instance is None:
        cls._instance = super().__new__(cls)
        cls._instance.app = app  # Сохраняем ссылку на приложение
    return cls._instance
```

Гарантирует единственный экземпляр класса

Хранит ссылку на Flask-приложение для доступа к конфигурации



![Лабораторная работа 5. Задание 1](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR5-4sem/старт.png)

![Лабораторная работа 5. Задание 1](https://github.com/Stepanova-Anna/Programming-2/blob/main/LR5-4sem/курсы.png)
